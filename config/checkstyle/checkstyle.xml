<?xml version="1.0"?>
<!DOCTYPE module PUBLIC
  "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"
  "https://checkstyle.org/dtds/configuration_1_3.dtd">

<!--
  Checkstyle configuration tuned for Spring Boot 4 projects running on Java 25.
  The rules avoid layout-specific checks so that external formatters
  (e.g., IDE defaults or Spring Java Format) remain the source of truth
  for whitespace and wrapping concerns. Each rule includes a short note and
  a sample to clarify intent without constraining formatter choices.
-->
<module name="Checker">
  <property name="charset" value="UTF-8"/>
  <property name="severity" value="error"/>

  <!-- Enforces that only Java source files are checked; sample: src/main/java/App.java passes, App.kt is ignored. -->
  <property name="fileExtensions" value="java,xml,properties"/>

  <!-- Allows central suppressions for generated or legacy code; sample: config/checkstyle/suppressions.xml can mute */generated/* classes. -->
  <module name="SuppressionFilter">
    <property name="file" value="${config_loc}/suppressions.xml"/>
  </module>

  <!-- Lets developers silence checks inline when necessary; sample: // CHECKSTYLE:OFF before a test helper and // CHECKSTYLE:ON after. -->
  <module name="SuppressWithPlainTextCommentFilter">
    <property name="offCommentFormat" value="CHECKSTYLE:OFF"/>
    <property name="onCommentFormat" value="CHECKSTYLE:ON"/>
    <property name="checkFormat" value=".*"/>
  </module>

  <!-- Requires a trailing newline so diff tools and scripts behave predictably; sample: a file missing the final newline is reported. -->
  <module name="NewlineAtEndOfFile">
    <property name="lineSeparator" value="lf"/>
  </module>

  <!-- Forbids tab characters to keep indentation under formatter control; sample: a tab in indentation triggers a warning. -->
  <module name="FileTabCharacter">
    <property name="eachLine" value="true"/>
  </module>

  <module name="TreeWalker">
    <!-- Ensures filename matches the public type name; sample: class OrderService must live in OrderService.java. -->
    <module name="OuterTypeFilename"/>
    <!-- Demands a package declaration for non-default packaging; sample: a class missing 'package com.example;' is flagged. -->
    <module name="PackageDeclaration"/>
    <!-- Enforces upper camel case for classes/interfaces, aligning with Java 25 records/sealed classes; sample: class userService is rejected. -->
    <module name="TypeName"/>
    <!-- Enforces lower camel case for fields; sample: int user_count is rejected, int userCount passes. -->
    <module name="MemberName"/>
    <!-- Requires lower camel case for method parameters; sample: void saveUser(String User) is rejected, saveUser(String user) passes. -->
    <module name="ParameterName"/>
    <!-- Requires lower camel case for local variables; sample: var UserId = 1 is rejected, var userId = 1 passes. -->
    <module name="LocalVariableName"/>
    <!-- Requires clear names for pattern variables introduced in switch/instanceof; sample: if (obj instanceof Order order) passes, Order oRDER fails. -->
    <module name="PatternVariableName"/>
    <!-- Ensures catch parameters use lower camel case; sample: catch (Exception E) is rejected, catch (Exception e) passes. -->
    <module name="CatchParameterName"/>
    <!-- Requires record components to follow lower camel case, fitting Java 25 records; sample: record User(String UserName) is rejected, User(String userName) passes. -->
    <module name="RecordComponentName"/>

    <!-- Blocks use of internal JDK packages that break portability; sample: import sun.misc.Unsafe triggers a violation. -->
    <module name="IllegalImport">
      <property name="illegalPkgs" value="sun,com.sun"/>
    </module>

    <!-- Disallows star imports to keep dependencies explicit; sample: import java.util.* is rejected, import java.util.List passes. -->
    <module name="AvoidStarImport"/>
    <!-- Limits static star imports while allowing AssertJ convenience; sample: import static java.lang.Math.* is rejected, AssertJ wildcard passes. -->
    <module name="AvoidStaticImport">
      <property name="excludes" value="org.assertj.core.api.Assertions.*"/>
    </module>
    <!-- Removes unused imports so builds remain clean; sample: an import never referenced in the file is flagged. -->
    <module name="UnusedImports"/>
    <!-- Flags duplicate imports to reduce noise; sample: importing java.util.List twice is rejected. -->
    <module name="RedundantImport"/>

    <!-- Restricts files to a single top-level class to simplify navigation; sample: defining two public classes in one file is rejected. -->
    <module name="OneTopLevelClass"/>

    <!-- Enforces explicit visibility on fields and methods, allowing immutable public constants; sample: package-private field without modifier is flagged. -->
    <module name="VisibilityModifier">
      <property name="allowPublicImmutableFields" value="true"/>
    </module>
    <!-- Marks utility classes as final when they only have static members; sample: a static helper class without final is flagged. -->
    <module name="FinalClass"/>
    <!-- Requires private constructors in utility classes to prevent instantiation; sample: a class with only static methods but public constructor is rejected. -->
    <module name="HideUtilityClassConstructor"/>

    <!-- Keeps modifiers in Java-recommended order for readability; sample: writing public static final instead of final static public. -->
    <module name="ModifierOrder"/>
    <!-- Removes redundant modifiers such as 'public' on interface methods; sample: public interface Foo { public void bar(); } is flagged. -->
    <module name="RedundantModifier"/>

    <!-- Requires @Override on overriding methods to catch signature mistakes; sample: missing @Override on subclass method is flagged. -->
    <module name="MissingOverride"/>

    <!-- Demands braces on control statements to avoid accidental bugs; sample: if (flag) doThing(); is rejected without braces. -->
    <module name="NeedBraces">
      <property name="allowSingleLineStatement" value="false"/>
    </module>

    <!-- Flags empty blocks unless they contain explanatory text; sample: an empty catch {} is rejected, catch { // ignore } passes. -->
    <module name="EmptyBlock">
      <property name="option" value="TEXT"/>
      <property name="tokens" value="LITERAL_TRY, LITERAL_CATCH, LITERAL_FINALLY, LITERAL_IF, LITERAL_ELSE, LITERAL_SWITCH, LITERAL_SYNCHRONIZED, LITERAL_WHILE, LITERAL_DO, LITERAL_FOR"/>
    </module>

    <!-- Prevents throwing overly generic exceptions; sample: method declares throws Exception is flagged, throws IOException passes. -->
    <module name="IllegalThrows"/>

    <!-- Simplifies boolean expressions for clarity; sample: if (flag == true) is flagged, if (flag) passes. -->
    <module name="SimplifyBooleanExpression"/>
    <!-- Encourages straightforward boolean returns; sample: return condition ? true : false is flagged, return condition passes. -->
    <module name="SimplifyBooleanReturn"/>

    <!-- Discourages direct instantiation of classes meant for factories/singletons; sample: new Boolean(true) is flagged in favor of Boolean.valueOf. -->
    <module name="IllegalInstantiation"/>
    <!-- Forbids declaring multiple variables in one statement for readability; sample: int a, b; is flagged, separate declarations pass. -->
    <module name="MultipleVariableDeclarations"/>
    <!-- Ensures switch statements place default last for predictability; sample: default case before other cases is flagged. -->
    <module name="DefaultComesLast"/>
    <!-- Disallows finalizers which are deprecated in modern Java; sample: defining protected void finalize() is rejected. -->
    <module name="NoFinalizer"/>

    <!-- Requires a default branch in switch expressions/statements unless exhaustive; sample: switch on enum without default is flagged. -->
    <module name="MissingSwitchDefault"/>

    <!-- Enforces consistency between equals and hashCode implementations; sample: overriding equals without hashCode is flagged. -->
    <module name="EqualsHashCode"/>

    <!--
      Skip the HideUtilityClassConstructor check for classes annotated with @SpringBootApplication.
      The main application class is not meant to be treated as a utility class, so this rule
      should not apply here.
    -->
    <module name="SuppressionXpathSingleFilter">
      <property name="files" value="\.java$" />
      <property name="checks" value="HideUtilityClassConstructor" />
      <property name="query" value="//CLASS_DEF[.//ANNOTATION/IDENT[@text='SpringBootApplication']]" />
    </module>
  </module>
</module>
